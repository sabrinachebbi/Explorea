{% extends 'base.html.twig' %}
{% block meta_description %}
    <meta name="description" content="Consultez le résumé de votre réservation sur Exploréa. Vérifiez les détails de votre hébergement et/ou activités avant de confirmer ou de modifier votre demande.">

{% endblock %}

{% block header %}{% endblock %}
{% block footer %}{% endblock %}

{% block title %}Récapitulatif de la réservation{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('styles/summaryReserv.css') }}">
    <link rel="stylesheet" href="{{ asset('styles/notif.css') }}">
{% endblock %}

{% block body %}
    <a href="{{ path('app_accommodation_showAll') }}" class="back-to-accommodation">
        <img src="{{ asset('images/en-arriere.png') }}" alt="Retour aux hébergements" class="back-icon">
    </a>

    {# Afficher les messages flash #}
    {% for message in app.flashes('warning') %}
        <div class="alert-warning alert  flash-message ">
            <span>{{ message }}</span>
            <button class="close-" onclick="this.parentElement.style.display='none';">&times;</button>
        </div>
    {% endfor %}

    <div class="reservation-summary">
        <h2>Détail de la réservation</h2>

        {% if reservation.accommodation %}
            <p><strong>Hébergement :</strong> {{ reservation.accommodation.title }}</p>
        {% endif %}

        {% if reservation.activities|length > 0 %}
            <p><strong>Activités :</strong></p>
            <ul>
                {% for activity in reservation.activities %}
                    <li>
                        <p><strong>Activité :</strong> {{ activity.title }}</p>
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        <p><strong>Voyageur :</strong> {{ reservation.traveler.userProfile.firstName }} {{ reservation.traveler.userProfile.lastName }}</p>

        {% if reservation.accommodation %}
            <p><strong>Date de départ :</strong> {{ reservation.departureDate|date('d/m/Y') }}</p>
            <p><strong>Date de retour :</strong> {{ reservation.returnDate|date('d/m/Y') }}</p>
        {% else %}
            <p><strong>Date :</strong> {{ reservation.departureDate|date('d/m/Y') }}</p>
        {% endif %}

        <p><strong>Nombre de voyageurs :</strong> {{ reservation.voyagerNb }}</p>
        <p><strong>Total :</strong> {{ reservation.total }} €</p>

        <p><strong>Statut :</strong>
            {% if reservation.status.status.value == 'En attente' %}
                En attente de confirmation
            {% elseif reservation.status.status.value == 'Confirmé' %}
                Réservation confirmée
            {% elseif reservation.status.status.value == 'Annulé' %}
                Réservation annulée
            {% endif %}
        </p>

        {# Formulaire pour afficher les activités disponibles dans la même ville #}
        {% if form is defined %}
            {{ form_start(form) }}
            {% if form.activities is defined %}
                <h3 class="activity-title">Autres activités disponibles dans la même ville</h3>
                <div class="activity-checkboxes">
                    {% for activity in form.activities %}
                        <div class="activity-option">
                            {{ form_widget(activity) }}
                            {{ form_label(activity) }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
            {{ form_end(form) }}
        {% endif %}

        {# Boutons de confirmation et d'annulation #}
        <div class="buttons">
            <a href="{{ path('reservation_confirm', {'id': reservation.id}) }}" class="buttons btn_confirm">Confirmer</a>
            <a href="{{ path('reservation_cancel', {'id': reservation.id}) }}" class="buttons btn_cancel">Annuler</a>
        </div>
    </div>
{% endblock %}
